---
title: "Projekt statystyka"
output:
  html_document: default
  pdf_document: default
---
```{r include = FALSE}
knitr::opts_chunk$set(echo=FALSE)
set.seed(420)
nOfRuns <- 50
populationSize <- 10
budgetSum <- 0
```
```{r initial, results='hide', message=FALSE, warning=FALSE}
  library(tidyverse)
  library(ggplot2)
  library(gridExtra)
"kableExtra"
```
## Użyte algorytmy

### 1. GA
Algortym Genetyczny z biblioteki GA. Na start wybierane jest p punktów (gdzie p jest polulacją).
Następnie powtarzamy podane kroki:
- wyliczamy fitness score z populacji
- wybieramy osobników o największym fitness score, i dodajemy ich do populacji następnej ery
- krzyżujemy oraz mutujemy pozostałych osobników 

### 2. PRS
Poszukiwanie przypadkowe, polegające na wybierniu minimum z określonej ilościu losowo wybranych punktów z rozkładem jednostajnym w zadanej dziedzinie.

Ilość wywołań minimalizowanej funkcji w alrogytmie GA nie jest stała, z tego powodu, PRS wywoływany jest z budżetem równym średniej liczbie wywołań GA

## Funkcje użyte w porównaniu

#### 1.Ackley 
<br>
```{r Ackley, message=FALSE, warning=FALSE}
smoof::plot3D(smoof::makeAckleyFunction(2))
```
<br>
Global minimum: 0
<br>

#### 2.Rosenbrock

<br>
```{r Rosenborck}
rosen <- smoof::makeRosenbrockFunction(2)
smoof::plot3D(rosen)

```
<br>
Global minimum: 0


```{r PRS}
PRS <- function(f, n, dimensions=1){
    minimum <- unname(smoof::getLowerBoxConstraints(f)[1])
    maximum <- unname(smoof::getUpperBoxConstraints(f)[1])
  
  values <- replicate(n, f(runif(dimensions, min = minimum, max = maximum)));
  return(min(values))
}
```

```{r calculations}
calculatePRS <- function(f,n, dimensions, budget = 1000){
  temp_sol <- replicate(n, PRS(f, budget, dimensions))
  return(temp_sol)
}

calculateGA <- function(f, n, dimensions, population = populationSize, maxiter = 100){
  minimum <- unname(smoof::getLowerBoxConstraints(f)[1])
  maximum <- unname(smoof::getUpperBoxConstraints(f)[1])
  fitness <- function(x) -f(x)
  
  solutions_temp <- replicate(n, GA::ga(type ="real-valued", fitness = fitness, lower = replicate(dimensions, minimum), upper=replicate(dimensions, maximum), maxiter = maxiter, popSize=population, monitor = FALSE)@solution)
  solution <- c()
  iterator <- 1
  for (i in seq(1, (dimensions*n), by=dimensions)) {
    solution[iterator] <- f(solutions_temp[i:(i+(dimensions-1))])
    iterator = iterator + 1
  }
  return(solution)
}
```

## Przeprowadzenie prób losowych

### 1.Dwa wymiary

#### 1.1 Ackley
```{r Ackley_2}
Ackley_2 <- smoof::addCountingWrapper(smoof::makeAckleyFunction(2))
```

##### GA
```{r GA_Ackley_2}
smoof::resetEvaluationCounter(Ackley_2)
solutions_GA_Ackley_2 <- calculateGA(Ackley_2, n = nOfRuns, dimensions = 2)

mean_GA_Ackley_2 <- mean(solutions_GA_Ackley_2)
median_GA_Ackley_2 <- median(solutions_GA_Ackley_2)
GA_Ackley_2_stats <- c(mean_GA_Ackley_2,median_GA_Ackley_2)
names(GA_Ackley_2_stats) <- c('średnia', 'mediana')
GA_Ackley_2_stats

budget <- (smoof::getNumberOfEvaluations(Ackley_2) - nOfRuns) / nOfRuns
budgetSum <- budget
```

##### PRS
```{r PRS_Ackley_2}
solutions_PRS_Ackley_2 <- calculatePRS(Ackley_2, nOfRuns, 2, budget)

mean_PRS_Ackley_2 <- mean(solutions_PRS_Ackley_2)
median_PRS_Ackley_2 <- median(solutions_PRS_Ackley_2)
PRS_Ackley_2_stats <- c(mean_PRS_Ackley_2,median_PRS_Ackley_2)
names(PRS_Ackley_2_stats) <- c('średnia', 'mediana')
PRS_Ackley_2_stats

```

#### 1.2 Rosenbrock
```{r Rosenbrock_2}
Rosenbrock_2 <- smoof::addCountingWrapper(smoof::makeRosenbrockFunction(2))
```

##### GA
```{r GA_Rosenbrock_2}
smoof::resetEvaluationCounter(Rosenbrock_2)
solutions_GA_Rosenbrock_2 <- calculateGA(Rosenbrock_2, n = nOfRuns, dimensions = 2)

mean_GA_Rosenbrock_2 <- mean(solutions_GA_Rosenbrock_2)
median_GA_Rosenbrock_2 <- median(solutions_GA_Rosenbrock_2)
GA_Rosenbrock_2_stats <- c(mean_GA_Rosenbrock_2,median_GA_Rosenbrock_2)
names(GA_Rosenbrock_2_stats) <- c('średnia', 'mediana')
GA_Rosenbrock_2_stats

budget <- (smoof::getNumberOfEvaluations(Rosenbrock_2) - nOfRuns) / nOfRuns
budgetSum <- budgetSum + budget
```

##### PRS
```{r PRS_Rosenbrock_2}
solutions_PRS_Rosenbrock_2 <- calculatePRS(Rosenbrock_2, nOfRuns, 2, budget)

mean_PRS_Rosenbrock_2 <- mean(solutions_PRS_Rosenbrock_2)
median_PRS_Rosenbrock_2 <- median(solutions_PRS_Rosenbrock_2)
PRS_Rosenbrock_2_stats <- c(mean_PRS_Rosenbrock_2,median_PRS_Rosenbrock_2)
names(PRS_Rosenbrock_2_stats) <- c('średnia', 'mediana')
PRS_Rosenbrock_2_stats
```
Już przy 2 wymiarach widzimy przewagę algorytmu GA nad PRS. <br>
Podczas badania funkcji Ackleya, średnia minimów znaleznionych przez algorytm genetyczny jest ok 20 razy mniejsza od tej wyznaczonej Poszukiwaniem przypadkowym.<br>
W funkcji Rosenbrocka widzimy mniejszą różnice w wynikach: <br>
średnie minimum dla GA ~ 0.33 <br>
średnie minimum dla PRS ~ 0.59 <br>
Przy tych wynikach należy jednak spojrzeć na mediane, która w przypadku GA jest 5 razy mniejsza. Może to wskazywać na duże rozproszenie wyników i występowanie elementów odstających.

### 2 Dziesięć wymiarów

#### 2.1 Ackley
```{r Ackley_10}
Ackley_10 <- smoof::addCountingWrapper(smoof::makeAckleyFunction(10))
```


##### GA
```{r GA_Ackley_10}
smoof::resetEvaluationCounter(Ackley_10)
solutions_GA_Ackley_10 <- calculateGA(Ackley_10, n = nOfRuns, dimensions = 10)

mean_GA_Ackley_10 <- mean(solutions_GA_Ackley_10)
median_GA_Ackley_10 <- median(solutions_GA_Ackley_10)
GA_Ackley_10_stats <- c(mean_GA_Ackley_10,median_GA_Ackley_10)
names(GA_Ackley_10_stats) <- c('średnia', 'mediana')
GA_Ackley_10_stats

budget <- (smoof::getNumberOfEvaluations(Ackley_10) - nOfRuns) / nOfRuns
budgetSum <- budgetSum + budget
```

##### PRS
```{r PRS_Ackley_10}
solutions_PRS_Ackley_10 <- calculatePRS(Ackley_10, nOfRuns, 10, budget)

mean_PRS_Ackley_10 <- mean(solutions_PRS_Ackley_10)
median_PRS_Ackley_10 <- median(solutions_PRS_Ackley_10)
PRS_Ackley_10_stats <- c(mean_PRS_Ackley_10,median_PRS_Ackley_10)
names(PRS_Ackley_10_stats) <- c('średnia', 'mediana')
PRS_Ackley_10_stats
```

#### 2.2 Rosenbrock
```{r Rosenbrock_10}
Rosenbrock_10 <- smoof::addCountingWrapper(smoof::makeRosenbrockFunction(10))
```

##### GA
```{r GA_Rosenbrock_10}
smoof::resetEvaluationCounter(Rosenbrock_10)
solutions_GA_Rosenbrock_10 <- calculateGA(Rosenbrock_10, n = nOfRuns, dimensions = 10)

mean_GA_Rosenbrock_10 <- mean(solutions_GA_Rosenbrock_10)
median_GA_Rosenbrock_10 <- median(solutions_GA_Rosenbrock_10)
GA_Rosenbrock_10_stats <- c(mean_GA_Rosenbrock_10,median_GA_Rosenbrock_10)
names(GA_Rosenbrock_10_stats) <- c('średnia', 'mediana')
GA_Rosenbrock_10_stats

budget <- (smoof::getNumberOfEvaluations(Rosenbrock_10) - nOfRuns) / nOfRuns
budgetSum <- budgetSum + budget
```

##### PRS
```{r PRS_Rosenbrock_10}
solutions_PRS_Rosenbrock_10 <- calculatePRS(Rosenbrock_10, nOfRuns, 10, budget)

mean_PRS_Rosenbrock_10 <- mean(solutions_PRS_Rosenbrock_10)
median_PRS_Rosenbrock_10 <- median(solutions_PRS_Rosenbrock_10)
PRS_Rosenbrock_10_stats <- c(mean_PRS_Rosenbrock_10,median_PRS_Rosenbrock_10)
names(PRS_Rosenbrock_10_stats) <- c('średnia', 'mediana')
PRS_Rosenbrock_10_stats
```


### 3. Dwadzieścia wymiarów

#### 3.1 Ackley
```{r Ackley_20 }
Ackley_20 <- smoof::addCountingWrapper(smoof::makeAckleyFunction(20))
```

##### GA
```{r GA_Ackley_20}
smoof::resetEvaluationCounter(Ackley_20)
solutions_GA_Ackley_20 <- calculateGA(Ackley_20, n = nOfRuns, dimensions = 20)

mean_GA_Ackley_20 <- mean(solutions_GA_Ackley_20)
median_GA_Ackley_20 <- median(solutions_GA_Ackley_20)
GA_Ackley_20_stats <- c(mean_GA_Ackley_20,median_GA_Ackley_20)
names(GA_Ackley_20_stats) <- c('średnia', 'mediana')
GA_Ackley_20_stats

budget <- (smoof::getNumberOfEvaluations(Ackley_20) - nOfRuns) / nOfRuns
budgetSum <- budgetSum + budget
```

##### PRS
```{r PRS_Ackley_20}
solutions_PRS_Ackley_20 <- calculatePRS(Ackley_20, nOfRuns, 20, budget)

mean_PRS_Ackley_20 <- mean(solutions_PRS_Ackley_20)
median_PRS_Ackley_20 <- median(solutions_PRS_Ackley_20)
PRS_Ackley_20_stats <- c(mean_PRS_Ackley_20,median_PRS_Ackley_20)
names(PRS_Ackley_20_stats) <- c('średnia', 'mediana')
PRS_Ackley_20_stats
```

#### 3.2 Rosenbrock
```{r Rosenbrock_20}
Rosenbrock_20 <- smoof::addCountingWrapper(smoof::makeRosenbrockFunction(20))
```

##### GA
```{r GA_Rosenbrock_20}
smoof::resetEvaluationCounter(Rosenbrock_20)
solutions_GA_Rosenbrock_20 <- calculateGA(Rosenbrock_20, n = nOfRuns, dimensions = 20)

mean_GA_Rosenbrock_20 <- mean(solutions_GA_Rosenbrock_20)
median_GA_Rosenbrock_20 <- median(solutions_GA_Rosenbrock_20)
GA_Rosenbrock_20_stats <- c(mean_GA_Rosenbrock_20,median_GA_Rosenbrock_20)
names(GA_Rosenbrock_20_stats) <- c('średnia', 'mediana')
GA_Rosenbrock_20_stats

budget <- (smoof::getNumberOfEvaluations(Rosenbrock_20) - nOfRuns) / nOfRuns
budgetSum <- budgetSum + budget
``` 

##### PRS
```{r PRS_Rosenbrock_20}
solutions_PRS_Rosenbrock_20 <- calculatePRS(Rosenbrock_20, nOfRuns, 20, budget)

mean_PRS_Rosenbrock_20 <- mean(solutions_PRS_Rosenbrock_20)
median_PRS_Rosenbrock_20 <- median(solutions_PRS_Rosenbrock_20)
PRS_Rosenbrock_20_stats <- c(mean_PRS_Rosenbrock_20,median_PRS_Rosenbrock_20)
names(PRS_Rosenbrock_20_stats) <- c('średnia', 'mediana')
PRS_Rosenbrock_20_stats
```


```{r dataframe, results='hide', message=FALSE, warning=FALSE}
  r1 <- replicate(6 * nOfRuns, "PRS")
  r2 <- replicate(6 * nOfRuns, "GA")
  algorithm <- c(r1,r2)
  
  f1 <- replicate(3 * nOfRuns, "Ackley")
  f2 <- replicate(3 * nOfRuns, "Rosenbrock")
  f3 <- replicate(3 * nOfRuns, "Ackley")
  f4 <- replicate(3 * nOfRuns, "Rosenbrock")
  fun <- c(f1,f2,f3,f4)  
  
  d1 <- replicate(nOfRuns, 2)
  d2 <- replicate(nOfRuns, 10)
  d3 <- replicate(nOfRuns, 20)
  d4 <- replicate(nOfRuns, 2)
  d5 <- replicate(nOfRuns, 10)
  d6 <- replicate(nOfRuns, 20)
  dimensions <- c(d1,d2,d3,d4,d5,d6)
  
  values <- c(solutions_PRS_Ackley_2, solutions_PRS_Ackley_10, solutions_PRS_Ackley_20, solutions_PRS_Rosenbrock_2, solutions_PRS_Rosenbrock_10, solutions_PRS_Rosenbrock_20, solutions_GA_Ackley_2, solutions_GA_Ackley_10, solutions_GA_Ackley_20, solutions_GA_Rosenbrock_2, solutions_GA_Rosenbrock_10, solutions_GA_Rosenbrock_20)
  
  df <- data.frame(values, dimensions, fun, algorithm)
  df[,'dimensions']<-factor(df[,'dimensions'])
  df[,'fun']<-factor(df[,'fun'])
  df[,'algorithm']<-factor(df[,'algorithm'])
  summary(df)
  head(df)
```
### Porównanie 

#### Funkcja Ackley'a 2 wymiary

##### Rozłożenie wyników
```{r plot_Ackley_2, echo=FALSE}
  plot_Ackley_2_hist <- ggplot(df %>% filter(dimensions == 2, fun == "Ackley"), aes(x=values, color=algorithm))+
  geom_histogram(fill="white", alpha=0.5, position="identity",binwidth=1) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))

  plot_PRS_Ackley_2_violin <- df %>% filter(algorithm == "PRS", fun == "Ackley", dimensions == 2) %>% ggplot(aes(x=dimensions, y=values, color="blue")) +  geom_violin(color="lightblue") +  geom_boxplot(width=0.1, color="lightblue")+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)
  
  plot_GA_Ackley_2_violin <-  df %>% filter(algorithm == "GA", fun == "Ackley", dimensions == 2) %>% ggplot(aes(x=dimensions, y=values, color="red")) +  geom_violin()+ geom_boxplot(width=0.1)+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)

  grid.arrange(plot_Ackley_2_hist, arrangeGrob(plot_GA_Ackley_2_violin, plot_PRS_Ackley_2_violin), ncol=2,top = "Ackley 2 dimensions" )
```


```{r t.test_Ackley_2, echo=FALSE}
t.test( solutions_GA_Ackley_2, solutions_PRS_Ackley_2 )
```
p-wartość jest bardzo mała więc można z dużym prawdopodobieństwem założyć, że funkcje zwaracają różne wyniki

<br>

#### Funkcja Ackley'a 10 wymiarów

<br>
```{r plot_Ackley_10}
  plot_Ackley_10_hist <- ggplot(df %>% filter(dimensions == 10, fun == "Ackley"), aes(x=values, color=algorithm))+
  geom_histogram(fill="white", alpha=0.5, position="identity",binwidth=1) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))

  plot_PRS_Ackley_10_violin <- df %>% filter(algorithm == "PRS", fun == "Ackley", dimensions == 10) %>% ggplot(aes(x=dimensions, y=values, color="blue")) +  geom_violin(color="lightblue") +  geom_boxplot(width=0.1, color="lightblue")+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)
  
  plot_GA_Ackley_10_violin <-  df %>% filter(algorithm == "GA", fun == "Ackley", dimensions == 10) %>% ggplot(aes(x=dimensions, y=values, color="red")) +  geom_violin()+ geom_boxplot(width=0.1)+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)

  grid.arrange(plot_Ackley_10_hist, arrangeGrob(plot_GA_Ackley_10_violin, plot_PRS_Ackley_10_violin), ncol=2,top = "Ackley 10 dimensions" )
```
```{r t.test_Ackley_10}
t.test( solutions_GA_Ackley_10, solutions_PRS_Ackley_10 )
```
<br>

#### Funkcja Ackley'a 20 wymiarów

<br>
```{r plot_Ackley_20}
  plot_Ackley_20_hist <- ggplot(df %>% filter(dimensions == 20, fun == "Ackley"), aes(x=values, color=algorithm))+
  geom_histogram(fill="white", alpha=0.5, position="identity",binwidth=1) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))

  plot_PRS_Ackley_20_violin <- df %>% filter(algorithm == "PRS", fun == "Ackley", dimensions == 20) %>% ggplot(aes(x=dimensions, y=values, color="blue")) +  geom_violin(color="lightblue") +  geom_boxplot(width=0.1, color="lightblue")+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)
  
  plot_GA_Ackley_20_violin <-  df %>% filter(algorithm == "GA", fun == "Ackley", dimensions == 20) %>% ggplot(aes(x=dimensions, y=values, color="red")) +  geom_violin()+ geom_boxplot(width=0.1)+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)

  grid.arrange(plot_Ackley_20_hist, arrangeGrob(plot_GA_Ackley_20_violin, plot_PRS_Ackley_20_violin), ncol=2,top = "Ackley 20 dimensions" )
```
```{r t.test_Ackley_20}
t.test( solutions_GA_Ackley_20, solutions_PRS_Ackley_20 )
```
<br>

#### Funkcja Rosenbrock'a 2 wymiary

<br>
```{r plot_Rosenbrock_2}
  plot_Rosenbrock_2_hist <- ggplot(df %>% filter(dimensions == 2, fun == "Rosenbrock"), aes(x=values, color=algorithm))+
  geom_histogram(fill="white", alpha=0.5, position="identity",binwidth=0.2 ) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))

  plot_PRS_Rosenbrock_2_violin <- df %>% filter(algorithm == "PRS", fun == "Rosenbrock", dimensions == 2) %>% ggplot(aes(x=dimensions, y=values, color="blue")) +  geom_violin(color="lightblue") +  geom_boxplot(width=0.1, color="lightblue")+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)
  
  plot_GA_Rosenbrock_2_violin <-  df %>% filter(algorithm == "GA", fun == "Rosenbrock", dimensions == 2) %>% ggplot(aes(x=dimensions, y=values, color="red")) +  geom_violin()+ geom_boxplot(width=0.1)+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)+ scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))

  grid.arrange(plot_Rosenbrock_2_hist, arrangeGrob(plot_GA_Rosenbrock_2_violin, plot_PRS_Rosenbrock_2_violin), ncol=2,top = "Rosenbrock 2 dimensions" )
```
```{r t.test_Rosenbrock_2}
t.test( solutions_GA_Rosenbrock_2, solutions_PRS_Rosenbrock_2 )
```
<br>

#### Funkcja Rosenbrock'a 10 wymiarów

<br>
```{r plot_Rosenbrock_10}
  plot_Rosenbrock_10_hist <- ggplot(df %>% filter(dimensions == 10, fun == "Rosenbrock"), aes(x=values, color=algorithm))+
  geom_histogram(fill="white", alpha=0.5, position="identity",binwidth=5000) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))

  plot_PRS_Rosenbrock_10_violin <- df %>% filter(algorithm == "PRS", fun == "Rosenbrock", dimensions == 10) %>% ggplot(aes(x=dimensions, y=values, color="blue")) +  geom_violin(color="lightblue") +  geom_boxplot(width=0.1, color="lightblue")+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)
  
  plot_GA_Rosenbrock_10_violin <-  df %>% filter(algorithm == "GA", fun == "Rosenbrock", dimensions == 10) %>% ggplot(aes(x=dimensions, y=values, color="red")) +  geom_violin()+ geom_boxplot(width=0.1)+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)

  grid.arrange(plot_Rosenbrock_10_hist, arrangeGrob(plot_GA_Rosenbrock_10_violin, plot_PRS_Rosenbrock_10_violin), ncol=2,top = "Rosenbrock 10 dimensions" )
```
```{r t.test_Rosenbrock_10}
t.test( solutions_GA_Rosenbrock_10, solutions_PRS_Rosenbrock_10 )
```
<br>

#### Funkcja Rosenbrock'a 20 wymiarów

<br>
```{r plot_Rosenbrock_20}
  plot_Rosenbrock_20_hist <- ggplot(df %>% filter(dimensions == 20, fun == "Rosenbrock"), aes(x=values, color=algorithm))+
  geom_histogram(fill="white", alpha=0.5, position="identity",binwidth=10000) + scale_y_continuous(trans=scales::pseudo_log_trans(base = 10))

  plot_PRS_Rosenbrock_20_violin <- df %>% filter(algorithm == "PRS", fun == "Rosenbrock", dimensions == 20) %>% ggplot(aes(x=dimensions, y=values, color="blue")) +  geom_violin(color="lightblue") +  geom_boxplot(width=0.1, color="lightblue")+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)
  
  plot_GA_Rosenbrock_20_violin <-  df %>% filter(algorithm == "GA", fun == "Rosenbrock", dimensions == 20) %>% ggplot(aes(x=dimensions, y=values, color="red")) +  geom_violin()+ geom_boxplot(width=0.1)+ theme(legend.position = "none",axis.title.x = element_blank(),axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+stat_summary(fun="mean", color = "black", shape=20)

  grid.arrange(plot_Rosenbrock_20_hist, arrangeGrob(plot_GA_Rosenbrock_20_violin, plot_PRS_Rosenbrock_20_violin), ncol=2,top = "Rosenbrock 20 dimensions" )
```
```{r t.test_Rosenbrock_20}
t.test( solutions_GA_Rosenbrock_20, solutions_PRS_Rosenbrock_20 )
```

<br>

#### Podsumowanie

``` {r summary, results='asis', message=FALSE, warning=FALSE}
tableData <- data.frame(
  Dimensions = c( 2,2,10,10,20,20 ),
  Algorithm = c(replicate(3,c("GA","PRS"))),
    Mean = c( GA_Ackley_2_stats[1], PRS_Ackley_2_stats[1], GA_Ackley_10_stats[1], PRS_Ackley_10_stats[1], GA_Ackley_20_stats[1], PRS_Ackley_20_stats[1],
          GA_Rosenbrock_2_stats[1], PRS_Rosenbrock_2_stats[1], GA_Rosenbrock_10_stats[1], PRS_Rosenbrock_10_stats[1], GA_Rosenbrock_20_stats[1],
          PRS_Rosenbrock_20_stats[1]
          ),
  Median = c( GA_Ackley_2_stats[2], PRS_Ackley_2_stats[2], GA_Ackley_10_stats[2], PRS_Ackley_10_stats[2], GA_Ackley_20_stats[2], PRS_Ackley_20_stats[2],
            GA_Rosenbrock_2_stats[2], PRS_Rosenbrock_2_stats[2], GA_Rosenbrock_10_stats[2], PRS_Rosenbrock_10_stats[2], GA_Rosenbrock_20_stats[2],
            PRS_Rosenbrock_20_stats[2]
            )
  
)
tableData <- format(tableData, scientific = F, digits = 2)
knitr::kable(tableData, align = "c",caption = "An example table caption.") %>%
  kableExtra::kable_styling() %>%
  kableExtra::pack_rows("Ackley", 1, 6) %>%
  kableExtra::pack_rows("Rosembrock", 7, 12)
```




